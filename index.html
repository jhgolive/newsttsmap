<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‰´ìŠ¤2 + ìŒì„±</title>
  <style>
    body {
      margin: 0;
      background: transparent;
      overflow: hidden;
    }
    #wrapper {
      position: fixed;
      top: 0;
      left: 0;
      transform: translateY(-8px);
      z-index: 9999;
    }
    #news {
      position: fixed;
      top: 0;
      left: 0;
      white-space: nowrap;
      display: inline-block;
      font-size: 28px;
      color: white;
      font-weight: bold;
      text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black,
                   -1px -1px black, -1px 1px black, 1px -1px black, 1px 1px black;
      will-change: transform;
      backface-visibility: hidden;
      animation: scroll 120s linear infinite; /* ìŠ¤í¬ë¡¤ ì†ë„ ì¡°ì ˆ */
      z-index: 9999;
    }
    @keyframes scroll {
      0% { transform: translateX(100vw); }
      100% { transform: translateX(-100%); }
    }
  </style>
</head>
<body>
  <div id="wrapper">
    <div id="news">ë‰´ìŠ¤ ë¡œë”© ì¤‘...</div>
  </div>
  
  <script>
  const newsEl = document.getElementById("news");
  let lastNews = "";
  let speaking = false;

  // ğŸ—£ ë¸Œë¼ìš°ì € TTSë¡œ ë‰´ìŠ¤ ì œëª©ë“¤ì„ ì½ê¸°
  function speakNews(text) {
    if (!text) return;

    // ì´ì „ ìŒì„± ì¬ìƒ ì¤‘ì§€
    window.speechSynthesis.cancel();

    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "ko-KR";  // í•œêµ­ì–´
    utter.rate = 1.1;      // ë‰´ìŠ¤ ëŠë‚Œ ì‚´ë¦¬ê¸° ìœ„í•´ ì•½ê°„ ë¹ ë¥´ê²Œ
    utter.pitch = 1.0;
    utter.volume = 1.0;

    // ì‚¬ìš© ê°€ëŠ¥í•œ ìŒì„± ì¤‘ ko-KR ì°¾ê¸°
    const voices = speechSynthesis.getVoices();
    const koreanVoice = voices.find(v => v.lang.startsWith("ko"));
    if (koreanVoice) utter.voice = koreanVoice;

    speaking = true;
    utter.onend = () => { speaking = false; };

    speechSynthesis.speak(utter);
  }

  // ğŸ“° RSS ë‰´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
  async function loadNews() {
    try {
      const res = await fetch("https://api.rss2json.com/v1/api.json?rss_url=https://news.google.com/rss?hl=ko&gl=KR&ceid=KR:ko");
      const data = await res.json();
      if (!data.items) return;

      const newsTitles = data.items.map(i => i.title);
      const newsText = newsTitles.join("   |   ");

      if (newsText !== lastNews) {  // ë³€ê²½ëœ ê²½ìš°ì—ë§Œ ì ìš©
        newsEl.innerText = newsText;
        lastNews = newsText;
        speakNews(newsTitles.join("ã€‚ ")); // ì (ã€‚)ìœ¼ë¡œ ëŠì–´ì„œ ë‚­ë…
      }
    } catch (e) {
      console.error("ë‰´ìŠ¤ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨", e);
    }
  }

  // âœ… ì¼ë¶€ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìŒì„± ë¦¬ìŠ¤íŠ¸ê°€ ëŠ¦ê²Œ ë¡œë”©ë¨
  if (speechSynthesis.onvoiceschanged !== undefined) {
    speechSynthesis.onvoiceschanged = () => {};
  }

  // ì´ˆê¸° ì‹¤í–‰
  loadNews();
  setInterval(loadNews, 300000); // 5ë¶„ë§ˆë‹¤ ê°±ì‹ 
  </script>
</body>
</html>
